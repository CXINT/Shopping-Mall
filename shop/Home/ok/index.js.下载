"use strict";function arrangeGgroupText(a){return a=a.match(/.{1,4}/g)||[],a.join(" ")}var Cashier=React.createClass({displayName:"Cashier",getInitialState:function(){return $.extend(GLOBAL.initData,{selfData:{giftOpen:!1,phonePass:!1,dialogShow:!1,dialogType:1,giftCardBindSuccessShow:!1,lastClickRef:""},info:GLOBAL.initData.payOrdersSummary.giftcard_balance_info,showInfo:GLOBAL.initData.payOrdersSummary.giftcard_balance_info.info1||{},bondedWarehouse001:GLOBAL.initData.payOrdersSummary.bonded_warehouse_001}),GLOBAL.initData},render:function(){return React.createElement("div",{className:"main_content"},React.createElement("div",{className:"payment",id:"payment-method"},React.createElement(AsSoonPay,{cashier:this,desc:"最后一步,请..."}),React.createElement(CountDownTime,{cashier:this,desc:"倒计时"}),React.createElement(PayInfo,{cashier:this,desc:"应付金额"}),React.createElement(Advertise,{cashier:this,desc:"广告模块"}),React.createElement(Gift,{ref:"gift",cashier:this,desc:"礼品卡"}),React.createElement(Balance,{ref:"balance",cashier:this,desc:"账户余额"}),React.createElement(NeedPay,{ref:"needPay",cashier:this,desc:"账户余额下面的文字"}),React.createElement(ZeroNeedPay,{cashier:this,desc:"零元单"}),React.createElement(PayMethod,{cashier:this,desc:"支付方式"}),React.createElement(PayButton,{cashier:this,desc:"确认支付按钮"}),React.createElement(CheckPhoneOverlay,{ref:"checkPhoneOverlay",cashier:this}),React.createElement(ShadowForPay,{cashier:this,ref:"shadowForPay"})))}}),CountDownTime=React.createClass({displayName:"CountDownTime",getInitialState:function(){return{minute:20,second:0}},render:function(){return React.createElement("div",{className:"countdown_time_wrap"},React.createElement("strong",{className:"blackTip"},this.state.minute>=0||this.state.second>=0?React.createElement("strong",null,"请在 ",React.createElement("span",{className:"cart_countdown_time minute"},this.state.minute),"分",React.createElement("span",{className:"cart_countdown_time second"},this.state.second),"秒 内完成支付，并在下单后20分钟内完成支付。"):React.createElement("span",null,"已超过购物车商品保留时间，请尽快结算。")),React.createElement("a",{href:"javascript:void(0);",className:"sp_icon"},React.createElement("div",{className:"sp_icon_pos"},"由于商品库存有限，我们只能暂为您最多保存20分钟，",React.createElement("br",null),"20分钟后购物车将被清空，请尽快结算交易单。",React.createElement("div",null))))},componentDidMount:function(){var a=setInterval(function(){this.setState(function(b){return b.minute<=0&&b.second<=0?(clearInterval(a),void 0):((b.minute>0||b.second>0)&&(b.second=b.second-1,b.second<0&&b.minute>0&&(b.second=59,b.minute=b.minute-1)),b)}.bind(this))}.bind(this),1e3)}}),Advertise=React.createClass({displayName:"Advertise",render:function(){return this.props.cashier.state.advertising?React.createElement("div",{className:"adv","data-adid":"all_cart_confirmation_paymethod_platform_nulljs"},this.props.cashier.state.advertising):null}}),AsSoonPay=React.createClass({displayName:"AsSoonPay",render:function(){return React.createElement("h2",{className:"title"},"最后一步，请尽快付款！")}}),Balance=React.createClass({displayName:"Balance",changeClick:function(a){this.props.cashier.refs.gift.changeClick(a)},render:function(){return React.createElement("div",{id:"paytype_balance_info",className:0==this.props.cashier.state.payOrdersSummary.allow_balance?"hide":""},1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||2==this.props.cashier.state.payOrdersSummary.allow_balance?React.createElement("input",{id:"use_balance_checkbox","data-disabled":1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||2==this.props.cashier.state.payOrdersSummary.allow_balance,ref:"use_balance_checkbox",type:"checkbox",disabled:"disabled"}):React.createElement("input",{id:"use_balance_checkbox","data-disabled":1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||2==this.props.cashier.state.payOrdersSummary.allow_balance,onClick:this.changeClick,ref:"use_balance_checkbox",type:"checkbox"}),React.createElement("label",{htmlFor:"use_balance_checkbox",className:1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled?"disabled":"",style:{position:"relative",fontFamily:"Helvetica, arial, sans-serif",marginLeft:"0"}},React.createElement("span",{id:"paytype_balance"},"聚美余额支付 "),React.createElement("span",{className:!0},"  ",React.createElement("span",{className:"pink"},"¥"+(1*(this.props.cashier.state.showInfo.use_balance||"")).toFixed(2)),React.createElement("span",null,"（聚美余额共：",React.createElement("span",{id:"account_balance",className:"pink"},"¥"+(1*(this.props.cashier.state.showInfo.balance||"")).toFixed(2)),"）"))))}}),Gift=React.createClass({displayName:"Gift",getInitialState:function(){var a=this.props.cashier.state.payOrdersSummary.gift_card.forbiddenProducts,b=[];return Object.keys(a).length>0&&$.each(a,function(a,c){c.key=a,b.push(c)}),{list:b,showBind:!1,cardError:!1,inputNumber:"",cardErrorInfo:"您输入的礼品卡密码错误，请核对后重新输入"}},showGiftInputBox:function(){this.setState(function(a){return a.showBind=!a.showBind,a})},addGiftCard:function(){var a=this.refs.giftNoInput.value||"";a=a.replace(/\s/g,""),a.length<10?this.setState({cardError:!0,cardErrorInfo:"您输入的礼品卡密码错误，请核对后重新输入"}):$.post("/i/cart/ajax_bind_gift_card",{giftCardPwd:a,orderIds:this.props.cashier.state.orderIds.join(",")},function(a){1==a.status?(this.setState({cardError:!1,inputNumber:""}),this.props.cashier.setState(function(b){b.info=a.data.giftcard_balance_info;var c=this.props.cashier.refs.gift.refs.use_gift_card_checkbox.checked,d=this.props.cashier.refs.balance.refs.use_balance_checkbox.checked;return c||d||(b.showInfo=b.info.info1),!c&&d&&(b.showInfo=b.info.info2),c&&!d&&(b.showInfo=b.info.info3),c&&d&&(b.showInfo=b.info.info4),b}.bind(this))):this.setState({cardError:!0,cardErrorInfo:a.message})}.bind(this),"json")},changeClick:function(a){if(this.props.cashier.state.selfData.phonePass)this.props.cashier.setState(function(a){var b=this.props.cashier.refs.gift.refs.use_gift_card_checkbox.checked,c=this.props.cashier.refs.balance.refs.use_balance_checkbox.checked;return b||c||(a.showInfo=a.info.info1),!b&&c&&(a.showInfo=a.info.info2),b&&!c&&(a.showInfo=a.info.info3),b&&c&&(a.showInfo=a.info.info4),a}.bind(this)),this.props.cashier.refs.needPay.componentDidMount();else{a.preventDefault();var b=$(a.target).attr("id");this.props.cashier.setState(function(a){return a.selfData.lastClickRef=b,a}),this.props.cashier.refs.checkPhoneOverlay.setState(function(a){return a.showDialog=!0,a})}},handlerBlur:function(){this.setState({inputNumber:this.refs.giftNoInput.value||""})},render:function(){var a=this.state.list.map(function(a,b){return React.createElement("li",{key:b,style:{height:20}},b+1+"、"+a.item_short_name)});return React.createElement("div",{className:1==this.props.cashier.state.info.allNotAllow||0==this.props.cashier.state.payOrdersSummary.gift_card.allow_giftcard?"hide":"payment",id:"payment-method"},React.createElement("div",{className:"use-gift-card "},React.createElement("div",{className:"gift_card_info_wrap"},1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||0==1*(this.props.cashier.state.showInfo.giftCardBalance||"")||2==this.props.cashier.state.payOrdersSummary.gift_card.allow_giftcard?React.createElement("input",{type:"checkbox",ref:"use_gift_card_checkbox","data-disabled":1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||0==1*(this.props.cashier.state.showInfo.giftCardBalance||"")||2==this.props.cashier.state.payOrdersSummary.gift_card.allow_giftcard,disabled:"disabled",id:"use_gift_card_checkbox"}):React.createElement("input",{type:"checkbox",ref:"use_gift_card_checkbox","data-disabled":1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||0==1*(this.props.cashier.state.showInfo.giftCardBalance||"")||2==this.props.cashier.state.payOrdersSummary.gift_card.allow_giftcard,onClick:this.changeClick,id:"use_gift_card_checkbox"}),1==this.props.cashier.state.payOrdersSummary.chk_balance_disabled||2==this.props.cashier.state.payOrdersSummary.gift_card.allow_giftcard?React.createElement("label",{htmlFor:"use_gift_card_checkbox",className:"use_gift_card_label disabled"},"礼品卡支付",React.createElement("span",{className:"jumei-pink"},"  ",React.createElement("span",{className:"at-most"},"¥"+(1*(this.props.cashier.state.showInfo.use_gift_card||"")).toFixed(2))),"（礼品卡共:",React.createElement("span",{className:"jumei-pink"},React.createElement("span",{className:"current",style:{marginLeft:"8px"}},"¥"+(1*(this.props.cashier.state.showInfo.giftCardBalance||"")).toFixed(2))),"）"):React.createElement("label",{htmlFor:"use_gift_card_checkbox",className:"use_gift_card_label"},"礼品卡支付",React.createElement("span",{className:"jumei-pink"},"  ",React.createElement("span",{className:"at-most"},"¥"+(1*(this.props.cashier.state.showInfo.use_gift_card||"")).toFixed(2))),"（礼品卡共:",React.createElement("span",{className:"jumei-pink"},React.createElement("span",{className:"current",style:{marginLeft:"8px"}},"¥"+(1*(this.props.cashier.state.showInfo.giftCardBalance||"")).toFixed(2))),"）"),React.createElement("span",{className:"label",onClick:this.showGiftInputBox},React.createElement("div",{className:"pre-icon"},React.createElement("a",{href:"javascript:"},this.state.showBind?"--":"+")),React.createElement("a",{href:"javascript:",className:"use-gift-cart-label",style:{fontSize:"12px"}}," 绑定礼品卡"))),a.length>0?React.createElement("div",{className:"gift-cart-tip"},React.createElement("span",{className:"inline-block"},"订单中"),React.createElement("div",{className:"un-support-gift-card inline-block jumei-pink",style:{marginLeft:"5px"}},React.createElement("span",{className:"under-product"},"如下商品"),React.createElement("div",{className:"clear-bottom-line"}),React.createElement("div",{className:"info"},React.createElement("div",{className:"arrow"}),React.createElement("ul",null,a))),React.createElement("span",{className:"inline-block"},"不支持礼品卡支付。")):null,this.state.showBind?React.createElement("div",{className:"add-gift-cart"},React.createElement("input",{type:"text",id:"giftNoInput",defaultValue:this.state.inputNumber,onBlur:this.handlerBlur,ref:"giftNoInput",className:"gift-card-box",placeholder:"请输入您的礼品卡密码"}),React.createElement("div",{className:"gift-confirm confirm",onClick:this.addGiftCard},"确定"),this.state.cardError?React.createElement("div",{className:"gift-card-validation-info jumei-pink"},React.createElement("span",{className:"warning"}),React.createElement("span",{className:"gift-card-message"},this.state.cardErrorInfo)):null):null,this.state.giftCardBindSuccessShow?React.createElement("div",{className:"gift-card-success"},React.createElement("span",{className:"icon"},"✓"),"礼品卡绑定成功！ "):null))},componentDidUpdate:function(){this.componentDidMount()},componentDidMount:function(){$("#giftNoInput").keypress(function(a){var b=a.which||a.keyCode;if(8==b)return!0;if(1==a.ctrlKey&&(118==a.which||99==a.which)||1==a.metaKey&&(118==a.which||99==a.which))return!0;var c=$(a.target).val()||"";if(c=c.replace(/\s/g,""),16===c.length)return!1;a=a||window.event;var d=String.fromCharCode(a.which).toUpperCase(),e=/[A-Z0-9]/g;if(e.test(d)){var f=c+d;$(a.target).val(arrangeGgroupText(f))}return!1}).keyup(function(a){var b=$(this).val()||"";return b=b.replace(/\s/g,""),$(a.target).val(arrangeGgroupText(b)),!0})}}),NeedPay=React.createClass({displayName:"NeedPay",getInitialState:function(){return{show:!0}},render:function(){return this.props.cashier.state.showInfo.use_online>0&&this.state.show?React.createElement("div",{className:"other-pay use-gift-card",style:{display:"block",fontSize:"14px",fontFamily:"Helvetica, arial, sans-serif"}}," 剩余",React.createElement("span",{className:"jumei-pink pink",style:{margin:"0 8px"}},"¥"+(1*this.props.cashier.state.showInfo.use_online).toFixed(2)),"请选择以下付款方式 "):null},componentDidMount:function(){this.setState({show:!(!this.props.cashier.refs.gift.refs.use_gift_card_checkbox.checked&&!this.props.cashier.refs.balance.refs.use_balance_checkbox.checked)})}}),ZeroNeedPay=React.createClass({displayName:"ZeroNeedPay",render:function(){return""!=this.props.cashier.state.showInfo.tips?React.createElement("div",{className:"zero-order-tips",style:{display:"block"}},React.createElement("p",{className:"promo-card-tip",style:{display:"block"}},this.props.cashier.state.showInfo.tips),React.createElement(BalanceTip,{cashier:this.props.cashier})):React.createElement("div",{className:"zero-order-tips",style:{display:"block"}},React.createElement(BalanceTip,{cashier:this.props.cashier}))}}),BalanceTip=React.createClass({displayName:"BalanceTip",render:function(){return 0==this.props.cashier.state.payOrdersSummary.allow_balance||2==this.props.cashier.state.payOrdersSummary.allow_balance?React.createElement("div",null,React.createElement("p",{className:"promo-card-tip",style:{display:"block"}},this.props.cashier.state.payOrdersSummary.balance_txt)):null}}),PayButton=React.createClass({displayName:"PayButton",handleClick:function(){var a=$("#check_pay_form");a.append("<input type='hidden' name='orderIds' id='subOrderIds'/><input type='hidden' name='use_gift_card' id='subUseGiftCard'/><input type='hidden' name='use_balance' id='subUseBalance'/><input type='hidden' name='cartWebMobileFrom' id='subCartWebMobileFrom'/><input type='hidden' name='confirmationId' id='subConfirmationId'/><input type='hidden' name='lastgroup' id='subLastgroup'/>");var b=GLOBAL.initData,c=$("#use_gift_card_checkbox"),d=$("#use_balance_checkbox"),e=$("#subUseGiftCard",a),f=$("#subUseBalance",a);$("#subOrderIds",a).val(b.orderIds.join(",")),$("#subCartWebMobileFrom",a).val(b.blanceValid.cartWebMobileFrom),$("#subConfirmationId",a).val(b.confirmationId),$("#subLastgroup",a).val(b.lastgroup);var g=c.is(":checked")?1:0;g<<=1,g+=d.is(":checked")?1:0,g++;var h=GLOBAL.initData.payOrdersSummary.giftcard_balance_info["info"+g];c.is(":checked")?e.val(h.use_gift_card):e.val(0),d.is(":checked")?f.val(h.balanceCanUsed):f.val(0);var i=h.use_online;if(i>0){var j=$('input[name="gateway"]').filter(function(){return $(this).closest("li.gateway_line").is(":visible")&&!$(this).closest("li.gateway_line").hasClass("disabled")}).filter(":checked");if(0===j.length)return alert("请选择支付方式。"),!1}this.props.cashier.refs.shadowForPay.setState({show:!0}),a.attr("target","_blank").submit()},render:function(){return React.createElement("div",{className:"confirm_pay main_content clearfix",style:{paddingTop:35}},React.createElement("div",{className:"submit_box clearfix"},React.createElement("div",{className:"fr"},React.createElement("a",{href:"javascript:",className:"submit_btn",id:"JS_btn_confirm_pay",onClick:this.handleClick},"立即支付"))))}}),PayInfo=React.createClass({displayName:"PayInfo",render:function(){var a=this.props.cashier.state.payOrdersSummary.addressInfo,b=function(a){return"weekday"==a?"仅工作日送货":"weekend"==a?"仅周末送货":"工作日/周末/假日均可"};return React.createElement("div",{className:"order-info"},React.createElement("div",{className:"fl price-box"},"应付金额：",React.createElement("span",{className:"price"},"¥",React.createElement("span",{id:"JS_pay_total_amount"},(1*this.props.cashier.state.payOrdersSummary.giftcard_balance_info.totalAmount).toFixed(2)))),React.createElement("div",{className:"fl deliver-info"},React.createElement("p",{className:"address"},"收货信息："+a.receiver_name+"     "+a.structured_address+" "+a.address+"  "+a.hp),React.createElement("p",{className:"time"},"送货时间： "+b(this.props.cashier.state.payOrdersSummary.delivery_day))))}}),PayMethod=React.createClass({displayName:"PayMethod",getInitialState:function(){var a={};return a.last_pay_method=this.props.cashier.state.last_pay_method,a.allow_cod=this.props.cashier.state.payOrdersSummary.allow_cod,a.pay_methods=this.props.cashier.state.pay_methods,{payMethodData:a}},render:function(){return React.createElement("div",{className:"gateway_ul_box"},React.createElement("ul",{className:"gateway_ul"},React.createElement(GatewayLineList,{cashier:this.props.cashier,payMethodData:this.state.payMethodData})))}}),GatewayLineList=React.createClass({displayName:"GatewayLineList",render:function(){return React.createElement("div",null,React.createElement(LastPayMethod,{lastPay:this.props.payMethodData.last_pay_method}),React.createElement(CodPay,{ref:"codpay",cashier:this.props.cashier,allowCod:this.props.payMethodData.allow_cod}),React.createElement(PayTypeList,{cashier:this.props.cashier,payMethods:this.props.payMethodData.pay_methods}))},componentDidMount:function(){var a=$(".gateway_line"),b=$(".gateway_line>input").add(".gateway_line>div>input");b.click(function(c){b.attr("checked",!1),a.removeClass("ul_on").addClass("ul_off"),$(c.target).closest(".gateway_line").removeClass("ul_off").addClass("ul_on"),$(c.target).attr("checked",!0);var d=$('[name="gateway"]').filter(function(){return $(this).is(":checked")}),e="cod"==(d.val()||"").toLowerCase(),f=$("#use_gift_card_checkbox"),g=$("#use_balance_checkbox"),h=f.add(g);e?this.refs.codpay.handleClick():(h.each(function(){"false"==$(this).attr("data-disabled")&&$(this).attr("disabled",!1)}),g.parent().removeClass("disabled"),f.parent().removeClass("disabled"),$(".use-gift-cart-label").parent().unbind("click.show"),$("label.cod-not-support-balance").detach())}.bind(this));var c=$('input[name="gateway"]').filter(function(){return $(this).is(":checked")});c.closest(".gateway_line").find("input:first").attr("checked",!0),$('[name="gateway"]').filter(function(){return $(this).is(":checked")}).trigger("click")}}),LastPayMethod=React.createClass({displayName:"LastPayMethod",getInitialState:function(){return{lastMethod:this.props.lastPay}},render:function(){if(""!=this.state.lastMethod){var a=this.state.lastMethod+" bg";return React.createElement("li",{className:"gateway_line ul_on",id:"last_choose_mode"},React.createElement("input",{type:"radio",name:"gateway",id:"choose_before",defaultChecked:!0,defaultValue:this.state.lastMethod}),React.createElement("label",{className:"tit",htmlFor:"choose_before"},"上次支付方式"),React.createElement("label",{className:a,htmlFor:"choose_before"}))}return null}}),CodPay=React.createClass({displayName:"CodPay",getInitialState:function(){return{allowCod:this.props.allowCod}},handleClick:function(){setTimeout(function(){var a="cod"==($('[name="gateway"]:checked').val()||"").toLowerCase(),b=$("#use_gift_card_checkbox"),c=$("#use_balance_checkbox"),d=b.add(c),e=$(".gift_card_info_wrap"),f=$("#paytype_balance_info");a?(b.is(":checked")&&b.trigger("click"),c.is(":checked")&&c.trigger("click"),1==$(".add-gift-cart").length&&this.props.cashier.refs.gift.showGiftInputBox(),d.attr("disabled","disabled"),e.addClass("disabled"),f.addClass("disabled"),$(".use-gift-cart-label").parent().bind("click.show",function(){return!1}),(f.is(":visible")||e.is(":visible"))&&0==$(".cod-not-support-balance").length&&$("label.label-for-cod-checkbox").after('<label class="cod-not-support-balance pink">亲，货到付款不支持余额和礼品卡支付哦~</label>')):(d.removeAttr("disabled"),e.removeClass("disabled"),f.removeClass("disabled"),$(".use-gift-cart-label").parent().unbind("click.show"))}.bind(this),0)},render:function(){if(1==this.state.allowCod){var a=this.props.cashier.state.payOrdersSummary.addressInfo.structured_address,b=!1,c=this.props.cashier.state.codAlipayQRCodeScope;return $.each(c,function(c,d){return"all"==d?(b=!0,!1):""!=d&&0==a.indexOf(d)?(b=!0,!1):void 0}),React.createElement("li",{className:"gateway_line gateway_COD"},React.createElement("input",{type:"radio",ref:"cod",name:"gateway",defaultValue:"COD",id:"check-cod",onClick:this.handleClick}),React.createElement("label",{className:"tit label-for-cod-checkbox",htmlFor:"check-cod"},"货到付款"),b?React.createElement("label",{className:"supportCodWithWeixinQrCodeScan",style:{color:"rgb(0, 0, 0)",marginLeft:10,display:"inline"}},"支持支付宝扫码支付",React.createElement("a",{href:"http://f0.jmstatic.com/static_account/68040.html?v=4",target:"_blank",style:{color:"#0abfde",marginLeft:10,textDecoration:"none"}},"使用帮助？")):null)}return null},componentDidMount:function(){1==this.state.allow_cod&&"cod"==this.props.cashier.state.last_pay_method.toLowerCase()&&this.refs.cod.checked&&this.handleClick()}}),PayTypeList=React.createClass({displayName:"PayTypeList",getInitialState:function(){return{payMethods:this.props.payMethods,active:0}},render:function(){var a=[];$.each(this.props.payMethods,function(b,c){c instanceof Array||a.push(c)});var b=a.map(function(a,b){return React.createElement(PayType,{key:b,cashier:this.props.cashier,payTypeList:this,payMethod:a,payTypeIndex:b,checked:b==this.state.active&&!this.props.cashier.state.last_pay_method})}.bind(this));return React.createElement("div",null,b)}}),PayType=React.createClass({displayName:"PayType",getInitialState:function(){var a={methodList:{},headerInfo:{label:"",tips:[]}};return a.methodList=this.props.payMethod.pay_methods,a.headerInfo.label=this.props.payMethod.label,a.headerInfo.tips=this.props.payMethod.tips,{info:a}},render:function(){return React.createElement("div",null,React.createElement("li",{className:this.props.checked?"gateway_line ul_on":"gateway_line ul_off"},React.createElement(PayTypeHeader,{payTypeList:this.props.payTypeList,payTypeIndex:this.props.payTypeIndex,checked:!this.props.cashier.state.last_pay_method&&0==this.props.payTypeIndex,headerInfo:this.state.info.headerInfo}),React.createElement(PayMethodList,{cashier:this.props.cashier,payTypeIndex:this.props.payTypeIndex,methodList:this.state.info.methodList})))}}),PayTypeHeader=React.createClass({displayName:"PayTypeHeader",render:function(){var a="id"+(new Date).getTime();return React.createElement("div",null,React.createElement("input",{id:a,type:"radio"}),React.createElement("label",{className:"tit",htmlFor:a},this.props.headerInfo.label),React.createElement(GatewayDesc,{desc:this.props.headerInfo.tips}))}}),PayMethodList=React.createClass({displayName:"PayMethodList",render:function(){var a=[];$.each(this.props.methodList,function(b,c){a.push(c)});var b=a.map(function(a,b){return React.createElement(Method,{key:b,cashier:this.props.cashier,checked:0==this.props.payTypeIndex&&0==b,methodInfo:a})}.bind(this));return React.createElement("div",null,React.createElement("ul",{className:"third_ul clearfix g_ul"},b))}}),Method=React.createClass({displayName:"Method",render:function(){var a="bg "+this.props.methodInfo.value;return React.createElement("li",null,React.createElement("div",{className:"bd_wrap"},this.props.checked&&!this.props.cashier.state.last_pay_method?React.createElement("input",{type:"radio",defaultChecked:!0,defaultValue:this.props.methodInfo.value,name:"gateway",id:this.props.methodInfo.value}):React.createElement("input",{type:"radio",defaultValue:this.props.methodInfo.value,name:"gateway",id:this.props.methodInfo.value}),React.createElement("label",{title:this.props.methodInfo.name,className:a,htmlFor:this.props.methodInfo.value})))}}),GatewayDesc=React.createClass({displayName:"GatewayDesc",render:function(){var a=[];$.each(this.props.desc,function(b,c){a.push(c)});var b=a.map(function(a,b){return 1>b?React.createElement(Desc,{key:b,descInfo:a}):b>=1?React.createElement("div",{key:b,className:"inline-dev"},React.createElement("span",{className:"seperator"},"|"),React.createElement(Desc,{descInfo:a})):void 0}.bind(this));return React.createElement("div",{style:{display:"inline"}},b)}}),Desc=React.createClass({displayName:"Desc",render:function(){return React.createElement("label",{className:"tit gateway_desc alipay_activity_cod gateway_desc_new"},this.props.descInfo.title,React.createElement("a",{href:"javascript:void(0)"},React.createElement(DescTipText,{text:this.props.descInfo.text})))}}),DescTipText=React.createClass({displayName:"DescTipText",render:function(){if(!this.props.text.replace(/\s/g,""))return null;var a=this.props.text.split("\\n"),b=a.map(function(a,b){return 1>b?React.createElement("span",{key:b},a):b>=1?React.createElement("div",{key:b},React.createElement("br",null),a):void 0}.bind(this));return React.createElement("div",null,b,React.createElement("span",{className:"toolTipArrow"}))}}),CheckPhoneOverlay=React.createClass({displayName:"CheckPhoneOverlay",getInitialState:function(){return{phoneNumber:this.props.cashier.state.blanceValid.mobile,second:0,showDialog:!1,step:this.props.cashier.state.blanceValid.mobile?2:1}},getPhoneCode:function(a){if(this.state.second<=0){if(this.refs.bind_new_phone){var b=this.refs.bind_new_phone.value||"";if(!/^1\d{10}$/.test($.trim(b)))return alert("请输入正确的电话号码."),!1}var c=$(a.target).attr("data-type");this.setState({second:60}),this.refs.bind_new_phone&&(this.refs.bind_new_phone.disabled=!0);var d={action:"send_sms",from:this.props.cashier.state.blanceValid.cartWebMobileFrom,operationType:c,token:this.props.cashier.state.blanceValid.cartWebMobileToken,mobile:this.refs.bind_new_phone?this.refs.bind_new_phone.value:this.props.cashier.state.blanceValid.mobile};$.get("/i/account/ajax_mobile_bind",d,function(a){if(alert(a.message),"success"==a.error||"check_time_failed"==a.error){var b=this.refs.second.value;setTimeout(function(){var a=setInterval(function(){return this.state.second<=0?(clearInterval(a),this.refs.second&&(this.refs.second.value=b),this.refs.bind_new_phone&&(this.refs.bind_new_phone.disabled=!1),!1):(this.refs.second?this.refs.second.value=this.state.second--+"秒后重试":this.setState({second:0}),void 0)}.bind(this),1e3)}.bind(this),0)}else this.refs.bind_new_phone&&(this.refs.bind_new_phone.disabled=!1),this.setState({second:0})}.bind(this),"json")}},validPhone:function(a){var b={action:$(a.target).attr("data-action"),from:this.props.cashier.state.blanceValid.cartWebMobileFrom,operationType:$(a.target).attr("data-type"),token:this.props.cashier.state.blanceValid.cartWebMobileToken,confirm_code:this.refs.confirm_code_new_phone.value};this.refs.verify_code?(b.verify_code=this.refs.verify_code.value,b.mobile=this.props.cashier.state.blanceValid.mobile):b.mobile=this.refs.bind_new_phone.value,$.get("/i/account/ajax_mobile_bind",b,function(a){"success"==a.error?3!=this.state.step?(this.setState({showDialog:!1,second:0}),this.props.cashier.setState(function(a){return a.selfData.phonePass=!0,a}),setTimeout(function(){$("#"+this.props.cashier.state.selfData.lastClickRef).click()}.bind(this),0)):this.setState({step:4,second:0}):(this.refs.validCode&&this.changeCode(),alert(a.message))}.bind(this),"json")},closeDialog:function(){this.setState({showDialog:!1,step:this.props.cashier.state.blanceValid.mobile?2:1})},changeCode:function(){this.refs.validCode.src="/i/cart/hash_code?from=cart_balance&"+(new Date).getTime()},nextStep:function(a){this.setState({step:a,second:0}),this.refs.bind_new_phone&&(this.refs.bind_new_phone.disabled=!1)},render:function(){if(!this.state.showDialog)return null;switch(this.state.step){case 1:return React.createElement("div",null,React.createElement("div",{className:"cboxOverlay"}),React.createElement("div",{id:"mobile_confirm",className:"hide",style:{display:"block",position:"fixed",left:"50%",top:"40%",marginLeft:"-200px",marginTop:"-218.5px"}},React.createElement("div",{className:"header"},React.createElement("a",{className:"close",href:"javascript:void(0);",onClick:this.closeDialog},"关闭"),React.createElement("span",{className:"bold"},"余额支付安全验证")),React.createElement("div",{className:"body"},React.createElement("p",{style:{margin:"5px 0 10px 20px"}},"为保证您的余额资金安全，请进行手机验证"),React.createElement("div",{className:"mobile_form"},React.createElement("p",{className:"for-last-move",style:{marginLeft:36}},"手机号：",React.createElement("input",{name:"mobile",type:"text",ref:"bind_new_phone",className:"not_bind number-only",maxLength:11}),React.createElement("input",{name:"get_confirm_code",ref:"second",type:"button","data-type":"operationtype_user_bind_mobile",defaultValue:"获取校验码",onClick:this.getPhoneCode,className:"get_confirm_code number-only"})),React.createElement("p",{style:{marginLeft:36},className:"for-last-move"},React.createElement("span",null,"校验码："),React.createElement("input",{name:"confirm_code",ref:"confirm_code_new_phone",className:"input-mobile default_value number-only",type:"text",maxLength:6,style:{color:"#000"}})),React.createElement("p",{style:{marginLeft:87}},React.createElement("input",{type:"button",defaultValue:"提交手机绑定","data-action":"try_bind","data-type":"operationtype_user_bind_mobile",onClick:this.validPhone,className:"submit_subscribe",style:{display:"inline-block"}})),React.createElement("p",{className:"bind_tip not_bind grey",style:{margin:"0 0 15px 15px"}},"如原手机无法收到短信验证码，请联系聚美客服400-123-8888")))));case 2:return React.createElement("div",null,React.createElement("div",{className:"cboxOverlay"}),React.createElement("div",{id:"mobile_confirm",className:"hide",style:{display:"block",position:"fixed",left:"50%",top:"40%",marginLeft:"-200px",marginTop:"-231px"}},React.createElement("div",{className:"header"},React.createElement("a",{className:"close",href:"javascript:void(0);",onClick:this.closeDialog},"关闭"),React.createElement("span",{className:"bold"},"余额支付安全验证")),React.createElement("div",{className:"body"},React.createElement("p",{style:{margin:"5px 0 10px 20px"}},"为保证您的余额资金安全，请进行手机验证"),React.createElement("div",{className:"mobile_form"},React.createElement("p",{className:"for-last-move",style:{marginLeft:36}},React.createElement("span",{className:"step1 step2 is_bind",style:{display:"inline"}},"已绑定"),"手机号：",React.createElement("span",{className:"step1 step2 is_bind bold",style:{display:"inline"}},this.state.phoneNumber),React.createElement("input",{type:"button",defaultValue:"获取校验码",ref:"second","data-type":"operationtype_user_balance",onClick:this.getPhoneCode,className:"get_confirm_code number-only"})),React.createElement("p",{className:"is_bind",style:{margin:"10px 0 15px 87px"}},"换号了？",React.createElement("a",{href:"javascript:void(0);",onClick:this.nextStep.bind(this,3)},"绑定新手机号")),React.createElement("p",{style:{marginLeft:36},className:"for-last-move"},React.createElement("span",null,"校验码："),React.createElement("input",{className:"number-only",type:"text",maxLength:6,ref:"confirm_code_new_phone",style:{color:"#000"}})),React.createElement("p",{style:{marginLeft:36,display:"block"}},React.createElement("span",null,"验证码："),React.createElement("input",{className:"number-only",ref:"verify_code",type:"text",maxLength:4})),React.createElement("p",{style:{marginLeft:77,display:"block"}},React.createElement("img",{style:{marginLeft:10},ref:"validCode",src:"/i/cart/hash_code?from=cart_balance"}),React.createElement("a",{href:"javascript:void(0)",onClick:this.changeCode},"换一张")),React.createElement("p",{style:{marginLeft:87}},React.createElement("input",{type:"button",defaultValue:"确定","data-action":"check","data-type":"operationtype_user_balance",onClick:this.validPhone,className:"submit_subscribe"})),React.createElement("p",{className:"bind_tip not_bind grey",style:{margin:"0 0 15px 15px"}},"如原手机无法收到短信验证码，请联系聚美客服400-123-8888")))));case 3:return React.createElement("div",null,React.createElement("div",{className:"cboxOverlay"}),React.createElement("div",{id:"mobile_confirm",className:"hide",style:{display:"block",position:"fixed",left:"50%",top:"40%",marginLeft:"-200px",marginTop:"-231px"}},React.createElement("div",{className:"header"},React.createElement("a",{className:"close",href:"javascript:void(0);",onClick:this.closeDialog},"关闭"),React.createElement("span",{className:"bold"},"余额支付安全验证")),React.createElement("div",{className:"step"},React.createElement("div",{id:"mobile_step1",style:{display:"block"},className:"cart_step1"})),React.createElement("div",{className:"body"},React.createElement("p",{style:{margin:"5px 0 10px 20px"}},"为保证您的余额资金安全，请进行手机验证"),React.createElement("div",{className:"mobile_form"},React.createElement("p",{className:"for-last-move",style:{marginLeft:36}},React.createElement("span",{className:"step1 step2 is_bind",style:{display:"inline"}},"已绑定"),"手机号：",React.createElement("span",{className:"step1 step2 is_bind bold",style:{display:"inline"}},this.state.phoneNumber),React.createElement("input",{type:"button",defaultValue:"获取校验码",ref:"second","data-type":"operationtype_user_old_bind_mobile",onClick:this.getPhoneCode,className:"get_confirm_code number-only"})),React.createElement("p",{className:"step1 grey",style:{margin:"0px 0px 15px 87px",width:230,display:"block"}},"如原手机无法收到短信校验码，请联系聚美客服400-123-8888"),React.createElement("p",null),React.createElement("p",{className:"step2 not_bind grey for-last-move",style:{margin:"0px 0px 15px 118px",display:"none"}},"请输入正确的11位手机号码"),React.createElement("p",{style:{marginLeft:36},className:"for-last-move"},React.createElement("span",null,"校验码："),React.createElement("input",{className:"number-only",type:"text",maxLength:6,ref:"confirm_code_new_phone",style:{color:"#000"}})),React.createElement("p",{style:{marginLeft:36,display:"block"}},React.createElement("span",null,"验证码："),React.createElement("input",{className:"number-only",ref:"verify_code",type:"text",maxLength:4})),React.createElement("p",{style:{marginLeft:77,display:"block"}},React.createElement("img",{style:{marginLeft:10},ref:"validCode",src:"/i/cart/hash_code?from=cart_balance"}),React.createElement("a",{href:"javascript:void(0)",onClick:this.changeCode},"换一张")),React.createElement("p",{style:{marginLeft:87}},React.createElement("input",{type:"button",defaultValue:"下一步","data-action":"rebind_check","data-type":"operationtype_user_old_bind_mobile",onClick:this.validPhone,className:"submit_subscribe",style:{display:"inline-block"}}))))));
case 4:return React.createElement("div",null,React.createElement("div",{className:"cboxOverlay"}),React.createElement("div",{id:"mobile_confirm",className:"hide",style:{display:"block",position:"fixed",left:"50%",top:"40%",marginLeft:"-200px",marginTop:"-231px"}},React.createElement("div",{className:"header"},React.createElement("a",{className:"close",href:"javascript:void(0);",onClick:this.closeDialog},"关闭"),React.createElement("span",{className:"bold"},"余额支付安全验证")),React.createElement("div",{className:"step"},React.createElement("div",{id:"mobile_step2",style:{display:"block"},className:"cart_step2"})),React.createElement("div",{className:"body"},React.createElement("p",{style:{margin:"5px 0 10px 20px"}},"为保证您的余额资金安全，请进行手机验证"),React.createElement("div",{className:"mobile_form"},React.createElement("p",{className:"for-last-move",style:{marginLeft:16}},React.createElement("span",{className:"step1 step2 is_bind",style:{display:"inline"}},"已绑定"),"手机号：",React.createElement("span",{className:"step1 step2 is_bind bold",style:{display:"inline"}},this.state.phoneNumber)),React.createElement("p",{className:"for-last-move",id:"new_mobile",style:{marginLeft:16}},"新绑定手机号：",React.createElement("input",{name:"mobile",type:"text",ref:"bind_new_phone",className:"not_bind number-only",maxLength:11}),React.createElement("input",{type:"button",defaultValue:"获取校验码",ref:"second","data-type":"operationtype_user_bind_mobile",onClick:this.getPhoneCode,className:"get_confirm_code number-only"})),React.createElement("p",null),React.createElement("p",{className:"step2 not_bind grey for-last-move",style:{margin:"0px 0px 15px 98px",display:"block"}},"请输入正确的11位手机号码"),React.createElement("p",{style:{marginLeft:49},className:"for-last-move"},React.createElement("span",null,"校验码："),React.createElement("input",{type:"text",maxLength:6,defaultValue:"",className:"confirm_code_new_phone number-only",ref:"confirm_code_new_phone"})),React.createElement("p",{style:{marginLeft:87}},React.createElement("input",{type:"button",defaultValue:"绑定手机","data-action":"try_rebind","data-type":"operationtype_user_bind_mobile",onClick:this.validPhone,className:"submit_subscribe",style:{display:"inline-block"}}))))));default:return null}},componentDidUpdate:function(){$(".confirm_code_new_phone").val(""),$(".number-only").keypress(function(a){a=a||window.event;var b=a.which?a.which:event.keyCode;return!(b>31&&(48>b||b>57))}),$(".submit_subscribe").unbind("click.numberOnly").bind("click.numberOnly",function(){var a=$("input[name='mobile']").filter(":visible");if(a.length>0){var b=a.val(),c=/^1\d{10}$/;c.test(b)||alert("请输入正确的手机号码 ^_^ ")}})}}),ShadowForPay=React.createClass({displayName:"ShadowForPay",getInitialState:function(){return{show:!1}},refreshThis:function(){window.location.reload()},redirect:function(){window.location.href="/i/cart/payment_status/?order_id="+this.props.cashier.state.orderIds.join(",")},render:function(){return this.state.show?React.createElement("div",null,React.createElement("div",{className:"cboxOverlay",style:{opacity:"0.2",display:"block"}}),React.createElement("div",{id:"mobile_confirm",style:{display:"block",position:"fixed",left:"50%",top:"40%",marginLeft:"-200px",marginTop:"-231px"}},React.createElement("div",{className:"header",style:{height:"48px",background:"#f9f9f9",borderBottom:"1px solid #aeaeae"}},React.createElement("span",{className:"bold",style:{lineHeight:"50px"}},"请付款")),React.createElement("div",{className:"body",style:{height:"284px"}},React.createElement("div",{className:"mobile_form"},React.createElement("div",{className:"content"},React.createElement("h1",{className:"info"},"请您在新打开的页面上完成付款"),React.createElement("p",{style:{fontSize:"14px"}},"付款完成前请不要关闭此窗口"),React.createElement("p",{style:{fontSize:"14px"}},"完成付款后请根据您的情况点击下面的按钮"),React.createElement("p",{className:"ctrl",style:{marginTop:"20px"}},React.createElement("input",{type:"button",onClick:this.redirect,className:"f-button",style:{height:"30px"},defaultValue:"已完成付款"}),React.createElement("input",{type:"button",onClick:this.redirect,className:"f-button",style:{height:"30px"},defaultValue:"付款遇到问题"})),React.createElement("div",{className:"clear"}),React.createElement("a",{href:"javascript:",onClick:this.refreshThis,style:{display:"block",marginTop:"20px",fontSize:"14px"}},"» 返回选择其他支付方式")))))):null}});ReactDOM.render(React.createElement(Cashier,null),$("#check_pay_form")[0]);